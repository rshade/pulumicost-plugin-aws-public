{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://pulumicost.io/schemas/plugin-log-entry.json",
  "title": "PulumiCost Plugin Log Entry",
  "description": "JSON schema for zerolog structured log entries from aws-public plugin",
  "type": "object",
  "required": ["time", "level", "message", "plugin_name", "plugin_version"],
  "properties": {
    "time": {
      "type": "string",
      "format": "date-time",
      "description": "ISO8601 timestamp of log entry"
    },
    "level": {
      "type": "string",
      "enum": ["trace", "debug", "info", "warn", "error", "fatal", "panic"],
      "description": "Log severity level"
    },
    "message": {
      "type": "string",
      "description": "Human-readable log message"
    },
    "plugin_name": {
      "type": "string",
      "const": "aws-public",
      "description": "Plugin identifier"
    },
    "plugin_version": {
      "type": "string",
      "pattern": "^v?[0-9]+\\.[0-9]+\\.[0-9]+",
      "description": "Semantic version of the plugin"
    },
    "trace_id": {
      "type": "string",
      "description": "Request correlation ID (UUID format)"
    },
    "operation": {
      "type": "string",
      "enum": ["Name", "Supports", "GetProjectedCost", "GetActualCost", "GetPricingSpec"],
      "description": "gRPC method name"
    },
    "duration_ms": {
      "type": "integer",
      "minimum": 0,
      "description": "Request processing time in milliseconds"
    },
    "resource_type": {
      "type": "string",
      "enum": ["ec2", "ebs", "s3", "lambda", "rds", "dynamodb"],
      "description": "AWS resource type"
    },
    "aws_service": {
      "type": "string",
      "description": "AWS service name"
    },
    "aws_region": {
      "type": "string",
      "pattern": "^[a-z]{2}-[a-z]+-[0-9]+$",
      "description": "AWS region code (e.g., us-east-1)"
    },
    "instance_type": {
      "type": "string",
      "description": "EC2 instance type (e.g., t3.micro)"
    },
    "storage_type": {
      "type": "string",
      "description": "EBS volume type (e.g., gp3)"
    },
    "cost_monthly": {
      "type": "number",
      "minimum": 0,
      "description": "Calculated monthly cost in USD"
    },
    "unit_price": {
      "type": "number",
      "minimum": 0,
      "description": "Per-unit price"
    },
    "currency": {
      "type": "string",
      "const": "USD",
      "description": "Currency code"
    },
    "supported": {
      "type": "boolean",
      "description": "Whether resource is supported (Supports operation)"
    },
    "error": {
      "type": "string",
      "description": "Error message"
    },
    "error_code": {
      "type": "string",
      "enum": [
        "ERROR_CODE_UNSPECIFIED",
        "ERROR_CODE_INVALID_RESOURCE",
        "ERROR_CODE_UNSUPPORTED_REGION",
        "ERROR_CODE_DATA_CORRUPTION"
      ],
      "description": "Proto ErrorCode enum value"
    }
  },
  "additionalProperties": true
}
